# Changelog

## 4.4.0 (16.06.2025)

### Features
- В таблицу `Collection` добавлено поле `user_id`

### Fixes
- Исправлена ошибка в форме выбора коллекции при загрузке файла, когда
показывались коллекции других пользователей
- Исправлены все API которые используют коллекции.
Аналогично теперь каждому пользователю доступно обращение только к своим коллекциям

## 4.3.0 (15.06.2025)

### Features
- Дополнил API:
  - GET /logout — завершение сессии пользователя, удаление кук 
авторизации
  - POST /login — авторизация по логину и паролю в теле запроса
  - POST /register — создание пользователя по логину и паролю в теле 
запроса
  - PATCH /user/<user_password>/<new_user_password> — изменение пароля, переданного в теле 
запроса  
  Изменил ТЗ "PATCH /user/<user_id> — изменение пароля, переданного в теле 
запроса". Счёл нужным не передавать <user_id> тк пользователю разрешено менять только
свой пароль, информация об его логине в запросе излишняя. Вместо этого сделал ввод текущего пароля и нового пароля.
  - DELETE /user/<user_password> — удаление пользователя. Удаление 
аккаунта ведёт к завершению сессий пользователя. При удалении пользователя 
удаляются все его файлы и коллекции.

### Fixes
- Перенёс все API из `views.py` в `API.py`

## 4.2.0 (14.06.2025)

### Features
- Дополнил API:
  - POST /collection/<collection_id>/<document_id> — 
добавить документ в коллекцию
  - POST /collection/document_id> — 
удалить документ из коллекции заменив её id на None.  
  Сделано иначе чем в ТЗ "DELETE /collection/<collection_id>/<document_id> — 
удалить документ из коллекции"  
  Метод DELETE изменён на POST ввиду того, "удаление" из коллекции подразумевает
изменение поля `collection_id` у записи в таблице `Documents` на `None`, а не удаление записи вовсе
  - GET /collections/<collection_id>/statistics — получить 
статистику по коллекции: TF рассчитывается так, словно бы все документы в 
коллекции это один документ, IDF без изменений
  - GET /documents/<document_id>/statistics — получить 
статистику по данному документу (с учётом коллекции)

### Fixes
- Изменил функцию обработки текста для соответствия запросам API

## 4.1.0 (13.06.2025)

### Features
- Дополнил API:
  - GET /collections/ — получить список коллекций с id и списком 
входящих в них документов
  - GET /collections/<collection_id> — получить список id 
документов, входящих в конкретную коллекцию

## 4.0.0 (11.06.2025)

### MAJOR
- Добавил обязательное добавление коллекции документа
- Добавил таблицу для записи коллекций

### Features
- Дополнил API:
  - GET /documents/ — получить список документов (“id”: название), 
загруженным текущим пользователем
  - GET /documents/<document_id> — получить содержимое 
документа
  - DELETE /documents/<document_id> — удалить документ

## 3.1.0 (09.06.2025)

### Features
- Добавил возможность удалить аккаунт и изменить пароль

## 3.0.0 (08.06.2025)

### MAJOR
- Добавил обязательную авторизацию пользователей

### Features
- Добавил страницу регистрации и авторизации

## 2.2.0 (06.06.2025)

### Features
- Подключил к проекту Swagger и добавил описание api

## 2.1.0 (05.06.2025)

### Features
- добавил `docker-compose.yml`

## 2.0.0 (03.06.2025)

### MAJOR
- Замена базы данных sqlite3 на postgreSQL
- Вынесение параметров подключения к новой БД в `.env`

## 1.1.0 (02.06.2025)

### Fixes
- Исправлена ошибка подключения к базе данных

### Features
- Обновлён `views.py` для добавления информации о каждой обработке файла в модель `Main`:
  - `top_word` (CharField) — слово с наименьшим IDF
  - `time_processed` (FloatField) — время обработки файла в секундах
  - `time` (DateTimeField) — время добавления записи
  - `text_size` (IntegerField) — размер обработанного текста


- Реализован базовый API с необходимыми эндпойнтами:
  - `/status` — возвращает JSON `{ "status": "OK" }` при нормальной работе
  - `/version` — возвращает json `{"version": "версия приложения"}`, если всё хорошо
  - `/metrics` — возвращает метрики:
    - `files_processed` — количество обработанных файлов
    - `min_time_processed` — минимальное время обработки файла
    - `avg_time_processed` — среднее время обработки файла
    - `max_time_processed` — максимальное время обработки файла
    - `latest_file_processed_timestamp` — время обработки последнего файла в формате timestamp
    - `max_len_text` — максимальная длина текста
    - `avg_len_text` — средняя длина текста

## 1.0.0 (01.06.2025)

### Features
- Первоначальная версия проекта
- Добавлен базовый `Dockerfile` для запуска приложения
- Конфигурируемые параметры вынесены в `.env`